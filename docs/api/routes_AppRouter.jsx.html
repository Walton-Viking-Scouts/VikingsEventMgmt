<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: routes/AppRouter.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: routes/AppRouter.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { Suspense } from 'react';
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import { AppStateProvider } from '../shared/contexts/app';
import LoadingScreen from '../shared/components/LoadingScreen.jsx';
import ResponsiveLayout from '../shared/components/layout/ResponsiveLayout.jsx';
import TokenExpiredDialog from '../shared/components/TokenExpiredDialog.jsx';
import { useAuth } from '../features/auth/hooks';

// URL-based routing is now the only routing system

// Lazy load main feature modules for better performance
const MoversPage = React.lazy(() => import('../features/movements/components').then(module => ({ default: module.MoversPage })));
const SectionsPage = React.lazy(() => import('../features/sections/components').then(module => ({ default: module.SectionsPage })));
const EventsRouter = React.lazy(() => import('../features/events/components').then(module => ({ default: module.EventsRouter })));
const DataClearPage = React.lazy(() => import('../features/admin/components').then(module => ({ default: module.DataClearPage })));

// Import route guards (keep synchronous for security)
import { RouteGuard } from '../shared/components/guards';

/**
 * Internal routing component that handles authenticated Scout management interface.
 *
 * This component manages the core Scout application interface with authentication,
 * offline capabilities, and responsive layout. It provides the main navigation
 * structure for Scout leaders to manage sections, events, and member movements
 * while handling both online and offline operational modes.
 *
 * The component integrates authentication state, data synchronization, token
 * management, and responsive layout to deliver a seamless Scout management
 * experience across different devices and network conditions.
 *
 * @component
 * @returns {ReactElement} The authenticated Scout management interface with routing
 * @scout-themed
 * @offline-aware
 * @since 1.0.0
 * @example
 * // Used internally by AppRouter - not directly imported
 * // Handles authenticated routes like:
 * // /movers - Member movement tracking
 * // /sections - Scout section management  
 * // /events/* - Event management and attendance
 * // /clear - Administrative data management
 * @example
 * // Authentication states handled:
 * // - Loading: Shows authentication check screen
 * // - Authenticated: Shows full Scout interface
 * // - Offline: Shows cached data with sync options
 * // - Token expired: Shows re-authentication dialog
 * @example
 * // Scout workflow integration:
 * // 1. Section management (Beavers, Cubs, Scouts, Venturers, Rovers)
 * // 2. Member movement tracking between sections
 * // 3. Event creation and attendance management
 * // 4. Offline data synchronization with OSM API
 * // 5. Administrative tools for Scout leaders
 */
function AppContent() {
  const {
    isLoading,
    user,
    isBlocked: _isBlocked,
    isOfflineMode,
    authState,
    lastSyncTime,
    showTokenExpiredDialog,
    hasCachedData,
    handleReLogin,
    handleStayOffline,
    login,
    logout,
  } = useAuth();


  if (isLoading) {
    return &lt;LoadingScreen message="Checking authentication..." />;
  }

  const handleRefresh = async () => {
    if (isOfflineMode) {
      return;
    }
    try {
      const { default: syncService } = await import('../shared/services/storage/sync.js');
      await syncService.syncAll();
    } catch (error) {
      console.error('Refresh failed:', error);
    }
  };

  return (
    &lt;>
      &lt;ResponsiveLayout
        user={user}
        onLogout={logout}
        onLogin={login}
        onRefresh={handleRefresh}
        isOfflineMode={isOfflineMode}
        authState={authState}
        lastSyncTime={lastSyncTime}
        isRefreshing={false}
      >
        &lt;Suspense fallback={&lt;LoadingScreen message="Loading application..." />}>
          &lt;Routes>
            {/* Main application sections */}
            &lt;Route 
              path="/movers" 
              element={
                &lt;RouteGuard authLevel="none">
                  &lt;MoversPage />
                &lt;/RouteGuard>
              } 
            />
            &lt;Route 
              path="/sections" 
              element={
                &lt;RouteGuard authLevel="none">
                  &lt;SectionsPage />
                &lt;/RouteGuard>
              } 
            />
            &lt;Route 
              path="/events/*" 
              element={
                &lt;RouteGuard authLevel="none">
                  &lt;EventsRouter />
                &lt;/RouteGuard>
              } 
            />
            &lt;Route 
              path="/clear" 
              element={
                &lt;RouteGuard authLevel="none">
                  &lt;DataClearPage />
                &lt;/RouteGuard>
              } 
            />
            
            {/* Legacy route redirects */}
            &lt;Route path="/dashboard" element={&lt;Navigate to="/events" replace />} />
            &lt;Route path="/" element={&lt;Navigate to={`/events${window.location.search}`} replace />} />
          &lt;/Routes>
        &lt;/Suspense>
      &lt;/ResponsiveLayout>

      {/* Token expiration dialog */}
      &lt;TokenExpiredDialog
        isOpen={showTokenExpiredDialog}
        onReLogin={handleReLogin}
        onStayOffline={handleStayOffline}
        hasCachedData={hasCachedData}
      />
    &lt;/>
  );
}

/**
 * Main application router for the Viking Event Management Scout application.
 *
 * This is the primary routing component that establishes the browser-based navigation
 * system for Scout event management. It wraps the application in essential providers
 * for state management and routing, creating the foundation for offline-first
 * Scout operations and OSM API integration.
 *
 * The router handles all URL-based navigation, OAuth authentication flows, and
 * provides the context infrastructure needed for Scout section management,
 * member movements, and event coordination across the entire application.
 *
 * @component
 * @returns {ReactElement} The complete Scout application routing system with providers
 * @scout-themed
 * @offline-aware
 * @since 1.0.0
 * @example
 * // Primary usage as the main routing component
 * import AppRouter from './routes/AppRouter.jsx';
 * 
 * function App() {
 *   return (
 *     &lt;>
 *       &lt;AppRouter />
 *       &lt;Toaster />
 *     &lt;/>
 *   );
 * }
 * @example
 * // Supported Scout management routes:
 * // /events - Main Scout event management dashboard
 * // /events/create - Create new Scout events  
 * // /events/:id - View/edit specific Scout event
 * // /movers - Member movement tracking between sections
 * // /sections - Scout section overview (Beavers, Cubs, etc.)
 * // /clear - Administrative data management tools
 * @example
 * // OAuth and authentication flow handling:
 * // 1. Automatic OSM OAuth callback processing
 * // 2. Token storage and refresh management
 * // 3. Offline mode with cached Scout data
 * // 4. Token expiration and re-authentication
 * // 5. Scout group context and permissions
 * @example
 * // Context providers enabled:
 * // - AppStateProvider: Global Scout application state
 * // - BrowserRouter: URL-based navigation
 * // - Authentication context: User and session management
 * // - Offline capabilities: Cached data and sync status
 */
function AppRouter() {
  // URL-based routing with OAuth processing
  return (
    &lt;BrowserRouter>
      &lt;AppStateProvider>
        &lt;AppContent />
      &lt;/AppStateProvider>
    &lt;/BrowserRouter>
  );
}

export default AppRouter;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-DatabaseService.html">DatabaseService</a></li><li><a href="module-EventCard.html">EventCard</a></li><li><a href="module-FlexiRecordService.html">FlexiRecordService</a></li><li><a href="module-ageUtils.html">ageUtils</a></li><li><a href="module-auth.html">auth</a></li><li><a href="module-cacheCleanup.html">cacheCleanup</a></li><li><a href="module-flexiRecordTransforms.html">flexiRecordTransforms</a></li><li><a href="module-logger.html">logger</a></li><li><a href="module-notifications.html">notifications</a></li><li><a href="module-sectionHelpers.html">sectionHelpers</a></li></ul><h3>Namespaces</h3><ul><li><a href="module-logger-logger.html">logger</a></li></ul><h3>Classes</h3><ul><li><a href="APIQueue.html">APIQueue</a></li><li><a href="ErrorBoundary.html">ErrorBoundary</a></li><li><a href="RateLimitQueue.html">RateLimitQueue</a></li><li><a href="SyncService.html">SyncService</a></li><li><a href="module-DatabaseService-DatabaseService.html">DatabaseService</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Alert">Alert</a></li><li><a href="global.html#App">App</a></li><li><a href="global.html#AppContent">AppContent</a></li><li><a href="global.html#AppRouter">AppRouter</a></li><li><a href="global.html#AuthButton">AuthButton</a></li><li><a href="global.html#CampGroupCard">CampGroupCard</a></li><li><a href="global.html#CampGroupsView">CampGroupsView</a></li><li><a href="global.html#ConfirmModal">ConfirmModal</a></li><li><a href="global.html#DEMO_CACHE_DATA">DEMO_CACHE_DATA</a></li><li><a href="global.html#GroupNamesEditModal">GroupNamesEditModal</a></li><li><a href="global.html#Modal">Modal</a></li><li><a href="global.html#REQUIRED_VIKING_SECTION_MOVERS_FIELDS">REQUIRED_VIKING_SECTION_MOVERS_FIELDS</a></li><li><a href="global.html#SectionFilter">SectionFilter</a></li><li><a href="global.html#_generateProductionFormatAttendance">_generateProductionFormatAttendance</a></li><li><a href="global.html#assignMemberToCampGroupDemo">assignMemberToCampGroupDemo</a></li><li><a href="global.html#batchAssignMembers">batchAssignMembers</a></li><li><a href="global.html#buildEventCard">buildEventCard</a></li><li><a href="global.html#checkNetworkStatus">checkNetworkStatus</a></li><li><a href="global.html#clearFlexiRecordCaches">clearFlexiRecordCaches</a></li><li><a href="global.html#cn">cn</a></li><li><a href="global.html#convertSharedEventToAttendanceFormat">convertSharedEventToAttendanceFormat</a></li><li><a href="global.html#demoConfig">demoConfig</a></li><li><a href="global.html#expandSharedEvents">expandSharedEvents</a></li><li><a href="global.html#extractFlexiRecordContext">extractFlexiRecordContext</a></li><li><a href="global.html#fetchAllSectionEvents">fetchAllSectionEvents</a></li><li><a href="global.html#fetchEventAttendance">fetchEventAttendance</a></li><li><a href="global.html#fetchMostRecentTermId">fetchMostRecentTermId</a></li><li><a href="global.html#fetchSectionEvents">fetchSectionEvents</a></li><li><a href="global.html#filterEventsByDateRange">filterEventsByDateRange</a></li><li><a href="global.html#formatPhoneForCall">formatPhoneForCall</a></li><li><a href="global.html#generateDemoSharedAttendance">generateDemoSharedAttendance</a></li><li><a href="global.html#generateVikingSectionMoversErrorMessages">generateVikingSectionMoversErrorMessages</a></li><li><a href="global.html#getEventAttendance">getEventAttendance</a></li><li><a href="global.html#getEventSharingStatus">getEventSharingStatus</a></li><li><a href="global.html#getEventSummary">getEventSummary</a></li><li><a href="global.html#getEvents">getEvents</a></li><li><a href="global.html#getFlexiRecords">getFlexiRecords</a></li><li><a href="global.html#getFlexiStructure">getFlexiStructure</a></li><li><a href="global.html#getListOfMembers">getListOfMembers</a></li><li><a href="global.html#getMembersGrid">getMembersGrid</a></li><li><a href="global.html#getMostRecentTermId">getMostRecentTermId</a></li><li><a href="global.html#getSharedEventAttendance">getSharedEventAttendance</a></li><li><a href="global.html#getSingleFlexiRecord">getSingleFlexiRecord</a></li><li><a href="global.html#getStartupData">getStartupData</a></li><li><a href="global.html#getTerms">getTerms</a></li><li><a href="global.html#getUserAccessibleSections">getUserAccessibleSections</a></li><li><a href="global.html#getUserRoles">getUserRoles</a></li><li><a href="global.html#groupContactInfo">groupContactInfo</a></li><li><a href="global.html#groupEventsByName">groupEventsByName</a></li><li><a href="global.html#handleAPIResponseWithRateLimit">handleAPIResponseWithRateLimit</a></li><li><a href="global.html#handlePhoneCall">handlePhoneCall</a></li><li><a href="global.html#initializeDemoMode">initializeDemoMode</a></li><li><a href="global.html#isDemoMode">isDemoMode</a></li><li><a href="global.html#isSharedEventOwner">isSharedEventOwner</a></li><li><a href="global.html#isValidPhoneNumber">isValidPhoneNumber</a></li><li><a href="global.html#logRateLimitInfo">logRateLimitInfo</a></li><li><a href="global.html#mergeSharedAndSectionAttendance">mergeSharedAndSectionAttendance</a></li><li><a href="global.html#multiUpdateFlexiRecord">multiUpdateFlexiRecord</a></li><li><a href="global.html#organizeByCampGroups">organizeByCampGroups</a></li><li><a href="global.html#parseTimestamp">parseTimestamp</a></li><li><a href="global.html#quickValidateVikingSectionMovers">quickValidateVikingSectionMovers</a></li><li><a href="global.html#retrieveUserInfo">retrieveUserInfo</a></li><li><a href="global.html#safeCacheWithLogging">safeCacheWithLogging</a></li><li><a href="global.html#safeGetItem">safeGetItem</a></li><li><a href="global.html#safeGetSessionItem">safeGetSessionItem</a></li><li><a href="global.html#safeSetItem">safeSetItem</a></li><li><a href="global.html#safeSetSessionItem">safeSetSessionItem</a></li><li><a href="global.html#sleep">sleep</a></li><li><a href="global.html#sleepWithAbort">sleepWithAbort</a></li><li><a href="global.html#testBackendConnection">testBackendConnection</a></li><li><a href="global.html#updateFlexiRecord">updateFlexiRecord</a></li><li><a href="global.html#useAttendanceData">useAttendanceData</a></li><li><a href="global.html#useSignInOut">useSignInOut</a></li><li><a href="global.html#validateMemberMove">validateMemberMove</a></li><li><a href="global.html#validateTokenBeforeAPICall">validateTokenBeforeAPICall</a></li><li><a href="global.html#validateVikingSectionMoversFlexiRecord">validateVikingSectionMoversFlexiRecord</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Fri Sep 12 2025 17:57:38 GMT+0100 (British Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
